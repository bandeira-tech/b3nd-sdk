<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>b3nd Writer</title>
    <style>
      :root { --bg:#0b1020; --fg:#e7e9ee; --muted:#99a2bf; --accent:#6aa9ff; --ok:#22c55e; --err:#ef4444; --panel:#151b34; }
      * { box-sizing: border-box; }
      body { margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; background: var(--bg); color: var(--fg); }
      .wrap { width: 100%; max-width: none; margin: 0; padding: 12px; }
      h1 { margin: 0 0 12px; font-size: 22px; }
      .app-grid { display: grid; grid-template-columns: 240px minmax(0, 1fr) minmax(520px, 45vw); gap: 16px; align-items: start; }
      .card { background: var(--panel); border: 1px solid #1f274a; border-radius: 10px; padding: 16px; }
      .row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
      label { display: block; font-size: 12px; color: var(--muted); margin-bottom: 6px; }
      input, textarea { width: 100%; background: #0e142a; color: var(--fg); border: 1px solid #28325f; border-radius: 8px; padding: 10px 12px; font-family: inherit; }
      textarea { min-height: 100px; }
      .actions { display: flex; gap: 8px; flex-wrap: wrap; }
      button { background: #1b2347; color: var(--fg); border: 1px solid #2a366f; padding: 10px 12px; border-radius: 8px; cursor: pointer; }
      button.primary { background: var(--accent); border-color: var(--accent); color: black; }
      button:disabled { opacity: 0.6; cursor: not-allowed; }
      .log { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; background: #0a0f21; border: 1px solid #1b2347; border-radius: 8px; padding: 12px; min-height: 220px; max-height: 70vh; overflow: auto; font-size: 13px; }
      .log .line { white-space: pre-wrap; font-size: 12px; margin: 0 0 6px; color: var(--muted); }
      .log .ok { color: var(--ok); }
      .log .err { color: var(--err); }
      small { color: var(--muted); }

      .sidebar .nav { display: flex; flex-direction: column; gap: 8px; position: sticky; top: 24px; }
      .nav-item { text-align: left; padding: 10px 12px; border-radius: 8px; background: #111737; border: 1px solid #2a366f; color: var(--fg); }
      .nav-item.active { background: var(--accent); border-color: var(--accent); color: #000; }
      .section { display: none; }
      .section.visible { display: block; }
      .sidepanel { position: sticky; top: 12px; align-self: start; }
      #output { min-height: 35vh !important; }
      #log { min-height: 35vh !important; }

      @media (max-width: 1100px) {
        .app-grid { grid-template-columns: 1fr; }
        .sidebar, .sidepanel { position: static; }
      }
    </style>
  </head>
  <body>
    <noscript>
      <div style="background:#fee2e2;color:#7f1d1d;padding:8px 12px;text-align:center;">
        JavaScript is disabled. Enable it to use b3nd Writer.
      </div>
    </noscript>
    <div class="wrap">
      <h1>b3nd Writer</h1>
      <div class="app-grid">
        <aside class="sidebar">
          <div class="nav">
            <button class="nav-item active" data-section="section-config">Configuration</button>
            <button class="nav-item" data-section="section-auth">Auth</button>
            <button class="nav-item" data-section="section-write">Proxy Write</button>
          </div>
        </aside>

        <main class="content">
          <section id="section-config" class="card section visible">
            <h3>Configuration</h3>
            <div class="row" style="margin-top:8px;">
              <div>
                <label>Wallet Server URL</label>
                <input id="walletUrl" value="http://localhost:3001" placeholder="http://localhost:3001" />
              </div>
              <div>
                <label>API Base Path</label>
                <input id="apiBasePath" value="/api/v1" placeholder="/api/v1" />
              </div>
            </div>
            <div class="row" style="margin-top:8px;">
              <div>
                <label>Backend URL</label>
                <input id="backendUrl" value="http://localhost:8080" placeholder="http://localhost:8080" />
              </div>
              <div>
                <label>Backend Instance (optional)</label>
                <input id="backendInstance" value="default" placeholder="default" />
              </div>
            </div>
            <div class="actions" style="margin-top:10px;">
              <button id="applyConfig" class="primary">Apply Config</button>
              <button id="saveConfig">Save</button>
              <button id="loadConfig">Load</button>
              <button id="clearConfig">Clear</button>
            </div>
          </section>

          <section id="section-auth" class="card section">
            <h3>Auth</h3>
            <div class="row" style="margin-top:8px;">
              <div>
                <label>Username</label>
                <input id="username" />
              </div>
              <div>
                <label>Password</label>
                <input id="password" type="password" />
              </div>
            </div>
            <div class="actions" style="margin-top:10px;">
              <button id="signupBtn">Signup</button>
              <button id="loginBtn">Login</button>
              <button id="logoutBtn">Logout</button>
              <button id="healthBtn">Health</button>
              <button id="serverKeysBtn">Server Keys</button>
              <button id="myKeysBtn">My Keys</button>
            </div>
            <small id="authStatus">Not authenticated</small>
          </section>

          <section id="section-write" class="card section">
            <h3>Proxy Write</h3>
            <div class="row" style="margin-top:8px;">
              <div>
                <label>Unencrypted URI</label>
                <input id="plainUri" placeholder="mutable://accounts/:key/profile" />
              </div>
              <div>
                <label>Encrypted URI</label>
                <input id="encUri" placeholder="mutable://accounts/:key/private" />
              </div>
            </div>
            <div class="row" style="margin-top:8px;">
              <div>
                <label>Plain Payload (JSON)</label>
                <textarea id="plainPayload">{
  "name": "Test User",
  "bio": "Testing B3nd wallet client",
  "timestamp": ""
}</textarea>
              </div>
              <div>
                <label>Encrypted Payload (JSON)</label>
                <textarea id="encPayload">{
  "secret": "This is encrypted data",
  "apiKey": "super-secret-key-12345",
  "timestamp": ""
}</textarea>
              </div>
            </div>
            <div class="actions" style="margin-top:10px;">
              <button id="writePlainBtn">Write Plain</button>
              <button id="writeEncBtn">Write Encrypted</button>
              <button id="readLastBtn">Read Last From Backend</button>
              <button id="fullTestBtn" class="primary">Run Full Test</button>
            </div>
          </section>
        </main>

        <aside class="sidepanel">
          <div class="card">
            <h3>Output</h3>
            <pre class="log" id="output" style="min-height:120px"></pre>
          </div>
          <div class="card" style="margin-top:12px;">
            <h3>Log</h3>
            <div class="log" id="log"></div>
          </div>
        </aside>
      </div>
    </div>

    <script src="./writer.js" defer></script>
  </body>
  </html>
